CREATE TABLE IF NOT EXISTS conversations (id SERIAL PRIMARY KEY, created_at TIMESTAMP WITH TIME ZONE DEFAULT now(), updated_at TIMESTAMP WITH TIME ZONE DEFAULT now());
CREATE TABLE IF NOT EXISTS conversation_participants (conversation_id INT NOT NULL REFERENCES conversations(id) ON DELETE CASCADE, username VARCHAR(50) NOT NULL REFERENCES users(username) ON DELETE CASCADE, last_read_at TIMESTAMP WITH TIME ZONE DEFAULT now(), PRIMARY KEY (conversation_id, username));
CREATE TABLE IF NOT EXISTS messages (id SERIAL PRIMARY KEY, conversation_id INT NOT NULL REFERENCES conversations(id) ON DELETE CASCADE, sender VARCHAR(50) NOT NULL REFERENCES users(username) ON DELETE CASCADE, content TEXT NOT NULL, created_at TIMESTAMP WITH TIME ZONE DEFAULT now(), read BOOLEAN NOT NULL DEFAULT FALSE);
